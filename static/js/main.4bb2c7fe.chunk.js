(this["webpackJsonpviewer-demo"]=this["webpackJsonpviewer-demo"]||[]).push([[0],{128:function(e,t,a){e.exports=a.p+"static/media/gallery_layout.eb87d436.jpg"},129:function(e,t,a){e.exports=a.p+"static/media/gallery_g3_layout.4d9fd64e.png"},160:function(e,t,a){e.exports=a(543)},165:function(e,t,a){},530:function(e,t,a){},534:function(e,t,a){},535:function(e,t,a){},536:function(e,t,a){},537:function(e,t,a){},541:function(e,t,a){},543:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(12),l=a.n(r),i=a(137),s=(a(165),a(4)),c=a(597),d=a(29),m=a(608),h=a(606),u=a(601),p=a(607),g=a(609),b=a(605),f=a(40),E=a(598),v=a(588),w=a(124),y=a.n(w),k=a(127),C=a.n(k),x=a(126),S=a.n(x),O=a(590),j=a(591),N=a(592),G=a(25),L=a.n(G),M=a(125),R=a.n(M),I=a(70),B=a.n(I),P=a(596),_=a(595),F=a(589),D=a(594),z=a(593),V=a(8),W=a(587),A=a(118),X=a.n(A);const Z=e=>({root:{margin:0,padding:e.spacing(2)},closeButton:{position:"absolute",right:e.spacing(1),top:e.spacing(1),color:e.palette.grey[500]}});function H(e){const{open:t,setOpen:a,title:n,innerContent:r,icon:l,closeText:i,onClose:s,transition:c}=e,d=()=>{a(!1),s&&s()},m=o.a.useRef(null);o.a.useEffect(()=>{if(t){const{current:e}=m;null!==e&&e.focus()}},[t]);const h=Object(V.a)(Z)(e=>{const{children:t,classes:a,onClose:n,...r}=e;return o.a.createElement(W.a,Object.assign({disableTypography:!0,className:a.root},r),o.a.createElement(f.a,{variant:"h6"},t),o.a.createElement(v.a,{"aria-label":"close",className:a.closeButton,onClick:n},o.a.createElement(X.a,null)))});return o.a.createElement("div",null,o.a.createElement(F.a,{open:t,onClose:d,scroll:"paper","aria-labelledby":"scroll-dialog-title","aria-describedby":"scroll-dialog-description",TransitionComponent:c},o.a.createElement(h,{id:"scroll-dialog-title",onClose:d},o.a.createElement(O.a,null,o.a.createElement(j.a,null,l),o.a.createElement(N.a,{primary:n}))),o.a.createElement(z.a,{dividers:!0},r),o.a.createElement(D.a,null,o.a.createElement(_.a,{onClick:d,color:"primary"},i))))}var T=a(544),U=a(612),Y=a(121);class J extends n.PureComponent{render(){const{language:e,value:t}=this.props;return o.a.createElement(U.a,{language:e,style:Y.docco},t)}}J.defaultProps={language:null};var q=J,$=a(122),K=a.n($);const Q=o.a.forwardRef((function(e,t){return o.a.createElement(T.a,Object.assign({direction:"down",ref:t},e))}));function ee(e){const t=o.a.createElement(P.a,null,o.a.createElement(K.a,{source:"# Usage guide\n\nTwo things need to be set up on the SAME computer: the webapp and the camera control backend Flask app\n\n## Installation and starting\n\n### Webapp\n\nInstall **Node 14**. Might not work on later versions of Node\n\nOpen powershell/terminal in main folder (Shift + Right click) and type:\n\n- `npm install` (only need to do this once!)\n- `npm start`\n\nThe webapp should be running at `localhost:3000` (or `127.0.0.1:3000`)\n\n### Flask backend\n\nOpen a **separate** powershell inside `camera_control` folder containing the Flask app\n\nInstall the necessary packages:\n\n````\npip install flask\npip install opencv-python\npip install flask-cors\npip install moviepy\n````\n\n**Ensure all 4 cameras are connected before starting the Flask app.**\n\nStart the app with `python app.py`, The Flask app is running at `localhost:5001` (or `127.0.0.1:5001`)\n\n## Choosing cameras\n\nWe need to figure out which camera number is which. There are 4 links to check the cameras\n\n````\n127.0.0.1:5001/video_feed/0\n127.0.0.1:5001/video_feed/1\n127.0.0.1:5001/video_feed/2\n127.0.0.1:5001/video_feed/3\n````\n\nGo through them and note down where the cameras are pointing. We will then edit the code to change the camera links accordingly\n\n## Edit code to pick right camera\n\n### Live streaming cams\n\nNote the url for the two live streaming cams. \n\nOpen the file `src/Samuel.js` in a code editor, and search for the two constants `camera1Ip` and `camera2Ip`. Change those into the correct urls. **Save and reload website.**\n\n### Photogrammetry cams\n\nNo longer need to change manually\n\n## Restart apps\n\nIf there is any issue, hard restart the app by pressing Ctrl + C on the powershell terminal running the app, then press Y. Rerun the app with `npm start` for webapp or `python app.py` for Flask backend\n".replace(/^Demo(.*)$/gm,""),renderers:{code:q}}));return o.a.createElement(H,Object.assign({title:"About this 3D viewer",innerContent:t,icon:o.a.createElement(B.a,null),closeText:"Try it",transition:Q},e))}var te=a(75),ae=a(94),ne=a(613),oe=a(89),re=a.n(oe);const le=Object(c.a)(e=>({root:{padding:"2px 4px",display:"flex",alignItems:"center",width:"100%"},input:{marginLeft:e.spacing(1),flex:1},iconButton:{padding:10},divider:{height:28,margin:4}})),ie={flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",borderWidth:2,borderRadius:2,borderColor:"#eeeeee",borderStyle:"dashed",backgroundColor:"#fafafa",color:"#bdbdbd",outline:"none",transition:"border .24s ease-in-out"},se={borderColor:"#2196f3"},ce={borderColor:"#00e676"},de={borderColor:"#ff1744"};function me(e){const t=le(),{setFile:a}=e,[r,l]=Object(n.useState)(""),{acceptedFiles:i,getRootProps:s,getInputProps:c,isDragActive:d,isDragAccept:m,isDragReject:h,open:u}=Object(te.a)({onDrop:e=>{e.length>0&&g(e[0])}}),p=Object(n.useMemo)(()=>({...ie,...d?se:{},...m?ce:{},...h?de:{}}),[d,h,m]),g=t=>{e.setOpen(!1),a(t)},b=o.a.createElement(z.a,null,o.a.createElement("section",null,"You can load your own file to test this viewer.",o.a.createElement("h2",null,"From URL"),"Please enter a URL to your 3D file or to a public OnShape document.",o.a.createElement("div",{className:{alignItems:"center"}},o.a.createElement(ae.a,{component:"form",className:t.root},o.a.createElement(ne.a,{className:t.input,placeholder:"https://",onChange:e=>l(e.target.value),value:r}),o.a.createElement(E.a,{className:t.divider,orientation:"vertical"}),o.a.createElement(_.a,{className:t.iconButton,endIcon:o.a.createElement(re.a,null),onClick:()=>g(r)},"Load")))),o.a.createElement("section",null,o.a.createElement("h2",null,"From disk"),o.a.createElement("div",s({style:p}),o.a.createElement("input",c()),o.a.createElement("p",null,"Drag 'n' drop a 3D file here"),o.a.createElement(_.a,{type:"button",variant:"contained",onClick:u},"Browse..."))));return o.a.createElement(H,Object.assign({title:"Try open my files",innerContent:b,icon:o.a.createElement(L.a,null),closeText:"Close"},e))}var he=a(599),ue=a(614),pe=a(600),ge=a(611),be=(a(530),a(1)),fe=a(60),Ee=a(53),ve=a.n(Ee);const we=.001,ye=.001,ke=.001,Ce=Object(c.a)(e=>({root:{padding:"2px 4px",display:"flex",alignItems:"center",width:"100%"},input:{marginLeft:e.spacing(1),flex:1},iconButton:{padding:10},divider:{height:28,margin:4}})),xe={flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"20px",borderWidth:2,borderRadius:2,borderColor:"#eeeeee",borderStyle:"dashed",backgroundColor:"#fafafa",color:"#bdbdbd",outline:"none",transition:"border .24s ease-in-out"},Se={borderColor:"#2196f3"},Oe={borderColor:"#00e676"},je={borderColor:"#ff1744"};function Ne(e){Ce();const[t,a]=Object(n.useState)(null),[r,l]=Object(n.useState)(1),[i,s]=Object(n.useState)(1),[c,d]=Object(n.useState)(1),[m,h]=Object(n.useState)(1),[u,p]=Object(n.useState)(1),[g,b]=Object(n.useState)(1),[f,E]=Object(n.useState)(64),[v,w]=Object(n.useState)(1),[y,k]=Object(n.useState)(1),[C,x]=Object(n.useState)(0),[S,O]=Object(n.useState)(2*Math.PI),[j,N]=Object(n.useState)(32),[G,M]=Object(n.useState)(16),[R,I]=Object(n.useState)("0"),[B,P]=Object(n.useState)(""),{acceptedFiles:_,getRootProps:F,getInputProps:D,isDragActive:V,isDragAccept:W,isDragReject:A,open:X}=Object(te.a)({onDrop:e=>{e.length>0&&a(e[0])}}),Z=(Object(n.useMemo)(()=>({...xe,...V?Se:{},...W?Oe:{},...A?je:{}}),[V,A,W]),()=>{e.setOpen(!1),console.log(t);const a=URL.createObjectURL(t);console.log(a);const n=new be.Tb,o=new fe.a;n.load(a,(function(e){const t=new be.ab({map:e});switch(R){case"0":const e=new be.g(parseFloat(r),parseFloat(i),parseFloat(c));e.scale(we,ye,ke);const a=new be.Z(e,t);o.parse(a,e=>{const t=new Blob([JSON.stringify(e)],{type:"application/json"});ve()(t,"your_model.gltf")});break;case"1":const n=new be.q(m,g,i,f,v,!1);n.scale(we,ye,ke);const l=new be.Z(n,t);o.parse(l,e=>{const t=new Blob([JSON.stringify(e)],{type:"application/json"});ve()(t,"your_model.gltf")});break;case"2":const s=new be.Ob(u,j,G);s.scale(we,ye,ke);const d=new be.Z(s,t);o.parse(d,e=>{const t=new Blob([JSON.stringify(e)],{type:"application/json"});ve()(t,"your_model.gltf")});break;case"3":const h=new be.p(u,i,f);h.scale(we,ye,ke);const p=new be.Z(h,t);o.parse(p,e=>{const t=new Blob([JSON.stringify(e)],{type:"application/json"});ve()(t,"your_model.gltf")})}}),void 0,(function(e){console.error("An error happened.")}))}),T=o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{type:"number",placeholder:"Width(mm)",onChange:e=>l(e.target.value)}),o.a.createElement("input",{type:"number",placeholder:"Height(mm)",onChange:e=>s(e.target.value)}),o.a.createElement("input",{type:"number",placeholder:"Depth(mm)",onChange:e=>d(e.target.value)})),U=o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{type:"number",placeholder:"Height(mm)",onChange:e=>s(e.target.value)}),o.a.createElement("input",{type:"number",placeholder:"RadiusTop(mm)",onChange:e=>h(e.target.value)}),o.a.createElement("input",{type:"number",placeholder:"RadiusBottom(mm)",onChange:e=>b(e.target.value)}),o.a.createElement("input",{type:"number",placeholder:"RadialSegments",onChange:e=>E(e.target.value)}),o.a.createElement("input",{type:"number",placeholder:"HeightSegments",onChange:e=>w(e.target.value)})),Y=o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{type:"number",placeholder:"Height(mm)",onChange:e=>s(e.target.value)}),o.a.createElement("input",{type:"number",placeholder:"Radius(mm)",onChange:e=>p(e.target.value)}),o.a.createElement("input",{type:"number",placeholder:"RadialSegments",onChange:e=>E(e.target.value)})),J=o.a.createElement(o.a.Fragment,null,o.a.createElement("input",{type:"number",placeholder:"Radius(mm)",onChange:e=>p(e.target.value)}),o.a.createElement("input",{type:"number",placeholder:"WidthSegments",onChange:e=>N(e.target.value)}),o.a.createElement("input",{type:"number",placeholder:"HeightSegments",onChange:e=>M(e.target.value)})),q=o.a.createElement(z.a,{className:"dialogContent"},o.a.createElement("section",{className:"section"},o.a.createElement("h2",null,"Create a 3D Object")),o.a.createElement("div",{className:"choose-group"},o.a.createElement(he.a,{component:"legend"},"Shape"),"\xa0\xa0",o.a.createElement(ue.a,{className:"radio-group","aria-label":"shape",name:"shape",value:R,onChange:e=>{I(e.target.value)}},o.a.createElement(pe.a,{value:"0",control:o.a.createElement(ge.a,null),label:"Rect"}),o.a.createElement(pe.a,{value:"1",control:o.a.createElement(ge.a,null),label:"Cylinder"}),o.a.createElement(pe.a,{value:"2",control:o.a.createElement(ge.a,null),label:"Globe"}),o.a.createElement(pe.a,{value:"3",control:o.a.createElement(ge.a,null),label:"Circular"}))),o.a.createElement("section",{className:"section"},o.a.createElement("div",{className:"form-container"},o.a.createElement("form",{className:"model-form",onSubmit:e=>{e.preventDefault(),t&&Z()}},(e=>{switch(e){case"0":return T;case"1":return U;case"2":return J;case"3":return Y}})(R),o.a.createElement("input",{type:"file",accept:"image/*",onChange:e=>a(e.target.files[0])}),o.a.createElement("div",{className:"button-container"},o.a.createElement("button",{type:"submit",className:"button-12"},"Create 3D Object"))))));return o.a.createElement(H,Object.assign({title:"Upload image",innerContent:q,icon:o.a.createElement(L.a,null),closeText:"Close"},e))}var Ge=a(602),Le=a(603),Me=a(604),Re=a(90),Ie=a.n(Re);const Be=Object(c.a)(e=>({root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden",backgroundColor:e.palette.background.paper,margin:0,padding:0},gridList:{},icon:{color:"rgba(255, 255, 255, 0.5)"},header:{marginBottom:20},tile:{cursor:"pointer",opacity:.7,"&:hover":{opacity:1}}}));function Pe(e){var t,a,n;const r=Be(),l=e.format?o.a.createElement("div",null,o.a.createElement("div",{className:r.header},e.format.description,o.a.createElement("span",null,"  ",o.a.createElement(u.a,{href:e.format.url,target:"_blank"},"Read more...",o.a.createElement(Ie.a,{fontSize:"inherit"})))),o.a.createElement("div",{className:r.root},o.a.createElement(Ge.a,{cellHeight:180,className:r.gridList},e.format.models.map(t=>o.a.createElement(Le.a,{key:t.file,onClick:()=>(t=>{e.setOpen(!1),t.file.startsWith("http")?e.setFile(t.file):e.setFile(window.location+t.file)})(t),className:r.tile},o.a.createElement("img",{src:t.thumbnail}),o.a.createElement(Me.a,{title:t.name,subtitle:o.a.createElement("span",null,t.size),actionIcon:o.a.createElement(u.a,{href:t.file,target:"_blank"},o.a.createElement(v.a,{className:r.icon},o.a.createElement(Ie.a,null)))})))))):null;return o.a.createElement(H,Object.assign({innerContent:l,icon:o.a.createElement("img",{src:"formats/"+(null===(t=e.format)||void 0===t?void 0:t.id)+"/icon.png"}),closeText:"Close",title:(null===(a=e.format)||void 0===a?void 0:a.name)+" (*."+(null===(n=e.format)||void 0===n?void 0:n.extension)+")"},e))}var _e=a(50),Fe=a(7);a(534);const De=Object(c.a)(e=>({grow:{flexGrow:1},root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+2,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:310,width:"calc(100% - ".concat(310,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},hide:{display:"none"},drawer:{width:310,flexShrink:0,whiteSpace:"nowrap"},drawerOpen:{width:310,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:{transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:e.spacing(7)+1,[e.breakpoints.up("sm")]:{width:e.spacing(9)+1}},toolbar:{display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1),height:"60px"},content:{flexGrow:1,padding:e.spacing(1),height:"100vh",width:"100%"},innerContent:{display:"flex",height:"calc(100vh - 80px)",width:"100%"},sectionDesktop:{display:"none",[e.breakpoints.up("md")]:{display:"flex"}},sectionMobile:{display:"flex",[e.breakpoints.up("md")]:{display:"none"}},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ze=a(54),Ve=(a(535),a(128)),We=a.n(Ve),Ae=a(129),Xe=a.n(Ae);a(536);const Ze=e=>{let{position:t,value:a,checked:n,currentValue:r,width:l,height:i}=e;return o.a.createElement("div",{onClick:()=>n(a),style:{top:t.top,left:t.left,width:l?"".concat(l,"px"):"83px",height:i?"".concat(i,"px"):"83px"},className:r.includes(a)?"box-wrapper active":"box-wrapper"})},He=Object(c.a)(e=>({toolbar:{display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1),minHeight:"60px"}}));a(537);const Te=Object(c.a)(e=>({toolbar:{display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1),minHeight:"60px"}}));var Ue=a(610),Ye=a(144),Je=a(91),qe=a.n(Je);const $e=new Je.UnityContent("Build/build.json","Build/UnityLoader.js",{adjustOnWindowResize:!0}),Ke=Object(c.a)(e=>({root:{width:"100%",height:"100%"},unityContent:{background:"white",width:"100%",height:"100%"},paper:{padding:e.spacing(2),textAlign:"center",color:e.palette.text.secondary}}));function Qe(e){const t=Ke(),[a,r]=Object(n.useState)(!1),[l,i]=Object(n.useState)(null);$e.on("Ready",()=>{r(!0),s(),"function"==typeof e.onReady&&e.onReady()}),$e.on("OnLoaded",()=>{try{"function"==typeof e.onLoaded&&e.onLoaded()}catch{}}),$e.on("OnError",()=>{try{"function"==typeof e.onError&&e.onError()}catch{}}),Object(n.useEffect)(()=>{a&&s()},[e.file]);const s=()=>{try{if(e.file&&"object"==typeof e.file){var t=new FileReader;t.onload=(a=e.file,function(e){(window.filedata=window.filedata?window.filedata:{})[a.name]=e.target.result,$e.send("root","FileUpload",a.name),i(a.name)}),t.readAsArrayBuffer(e.file)}else"string"==typeof e.file?($e.send("root","Load",JSON.stringify({file:e.file})),i(e.file)):($e.send("root","Clear"),i(""))}catch(n){console.log(n),"function"==typeof e.onError&&e.onError()}var a};return o.a.createElement("div",{className:t.root},o.a.createElement(qe.a,{unityContent:$e,height:"100%",width:"100%",className:t.unityContent}))}const et="http://127.0.0.1:".concat(3e3,"/models"),tt="http://127.0.0.1:".concat(3e3,"/formats/FBX/models"),at=Object(c.a)(e=>({grow:{flexGrow:1},root:{display:"flex"},appBar:{zIndex:e.zIndex.drawer+2,transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen})},appBarShift:{marginLeft:310,width:"calc(100% - ".concat(310,"px)"),transition:e.transitions.create(["width","margin"],{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},menuButton:{marginRight:36},hide:{display:"none"},drawer:{width:310,flexShrink:0,whiteSpace:"nowrap"},drawerOpen:{width:310,transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.enteringScreen})},drawerClose:{transition:e.transitions.create("width",{easing:e.transitions.easing.sharp,duration:e.transitions.duration.leavingScreen}),overflowX:"hidden",width:e.spacing(7)+1,[e.breakpoints.up("sm")]:{width:e.spacing(9)+1}},toolbar:{display:"flex",alignItems:"center",justifyContent:"flex-end",padding:e.spacing(0,1),height:"60px"},content:{flexGrow:1,padding:e.spacing(1),height:"100vh",width:"100%"},innerContent:{display:"flex",height:"calc(100vh - 80px)",width:"100%"},sectionDesktop:{display:"none",[e.breakpoints.up("md")]:{display:"flex"}},sectionMobile:{display:"flex",[e.breakpoints.up("md")]:{display:"none"}},backdrop:{zIndex:e.zIndex.drawer+1,color:"#fff"}})),nt=function(){this.camera=new be.qb(50,window.innerWidth/window.innerHeight,1,2e4),this.camera.position.set(25,20,50),this.camera.lookAt(0,0,0),this.scene=new be.Ib,this.scene.background=new be.m(10526880),this.scene.fog=new be.x(16777215,200,2e3),this.dirLight=new be.r(16777215),this.dirLight.position.set(10,200,200),this.dirLight.intensity=1,this.dirLight.castShadow=!0,this.dirLight.shadow.camera.top=500,this.dirLight.shadow.camera.bottom=-500,this.dirLight.shadow.camera.left=-500,this.dirLight.shadow.camera.right=500,this.dirLight.shadow.camera.near=.5,this.dirLight.shadow.camera.far=1e3,this.scene.add(this.dirLight),this.dirLightBack=new be.r(16777215),this.dirLightBack.position.set(10,200,-200),this.dirLightBack.intensity=1,this.scene.add(this.dirLightBack);const e=new be.d(300);this.scene.add(e)},ot=function(){this.mesh=new be.Z(new be.sb(2e3,2e3),new be.cb({color:16777215,depthWrite:!1})),this.mesh.rotation.x=-Math.PI/2,this.mesh.receiveShadow=!0,this.mesh.name="Floor",this.scene.add(this.mesh);const e=new be.z(2e3,200,0,0);e.material.opacity=.2,e.material.transparent=!0,this.scene.add(e)};var rt=a(130),lt=a(133),it=a(132),st=a(131);const ct=function(){this.renderer=new be.ec({antialias:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.outputEncoding=be.fc,this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=be.pb,this.container.appendChild(this.renderer.domElement);const e=this;this.controls=new rt.a(this.camera,this.renderer.domElement),this.transformControls=new st.a(this.camera,this.renderer.domElement),this.transformControls.addEventListener("change",()=>{console.log("\u6a21\u578b\u62d6\u52a8")}),this.transformControls.addEventListener("dragging-changed",(function(t){e.controls.enabled=!t.value,console.log(e)})),this.scene.add(this.transformControls),this.trackballControls=new it.a(this.camera,this.renderer.domElement),this.dragControls=new lt.a(this.modelObject,this.camera,this.renderer.domElement),this.dragControls.addEventListener("dragstart",(function(){e.controls.enabled=!1})),this.dragControls.addEventListener("dragend",(function(){e.controls.enabled=!0})),this.controls.enablePan=!1,this.controls.update(),this.controls.enableDamping=!0,this.controls.autoRotate=!1};var dt=a(139),mt=a(134),ht=a(135),ut=a(140),pt=a(73),gt=a(136);const bt=function(){this.composer=new dt.a(this.renderer),this.renderPass=new mt.a(this.scene,this.camera),this.composer.addPass(this.renderPass),this.outlinePass=new ht.a(new be.ac(window.innerWidth,window.innerHeight),this.scene,this.camera),this.outlinePass.visibleEdgeColor.set(parseInt(65280)),this.outlinePass.hiddenEdgeColor=new be.m(0,0,0),this.composer.addPass(this.outlinePass);const e=new ut.a;this.composer.addPass(e),this.effectFXAA=new pt.a(gt.a),this.effectFXAA.uniforms.resolution.value.set(1/window.innerWidth,1/window.innerHeight),this.composer.addPass(this.effectFXAA),console.log(this)};var ft=a(76);const Et=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=[{key:"b7",value:et+"/G1/G1_B7.glb"},{key:"b8",value:et+"/G1/G1_B8.glb"},{key:"b9",value:et+"/G1/G1_B9.glb"},{key:"c6",value:et+"/G1/G1_C6.glb"},{key:"c7",value:et+"/G1/G1_C7.glb"},{key:"c8",value:et+"/G1/G1_C8.glb"},{key:"c9",value:et+"/G1/G1_C9.glb"},{key:"d6",value:et+"/G1/G1_D6.glb"},{key:"d7",value:et+"/G1/G1_D7.glb"},{key:"d8",value:et+"/G1/G1_D8.glb"},{key:"d9",value:et+"/G1/G1_D9.glb"},{key:"c11",value:et+"/G2/C11.glb"},{key:"d11",value:et+"/G2/D11.glb"},{key:"a1",value:et+"/G3/G3_A1.glb"},{key:"a2",value:et+"/G3/G3_A2.glb"},{key:"b1",value:et+"/G3/G3_B1.glb"},{key:"b2",value:et+"/G3/G3_B2.glb"},{key:"c1",value:et+"/G3/G3_C1.glb"},{key:"c2",value:et+"/G3/G3_C2.glb"}],a=t.filter(t=>e.includes(t.key)),n=this;a.forEach(e=>{(new ft.a).load(e.value,(function(t){const a=t.scene;switch(a.name="base_modal",e.key){case"b7":a.position.set(12,0,0);break;case"b8":a.position.set(21.7,0,0);break;case"b9":a.position.set(30.8,0,0);break;case"c6":a.position.set(2.3,0,9);break;case"c7":a.position.set(12,0,9);break;case"c8":a.position.set(21.7,0,9);break;case"c9":a.position.set(30.8,0,9);break;case"d6":a.position.set(2.3,0,18);break;case"d7":a.position.set(12,0,18);break;case"d8":a.position.set(21.7,0,18);break;case"d9":a.position.set(30.9,0,18.3);break;case"d11":case"c11":a.position.set(43,0,8);break;case"a1":a.position.set(0,0,2.7);break;case"a2":a.position.set(10,0,3.2);break;case"b1":a.position.set(0,0,12);break;case"b2":a.position.set(10,0,12.5);break;case"c1":a.position.set(0,0,22.3);break;case"c2":a.position.set(10,0,21.8)}n.scene.add(a)}))})};var vt=class{constructor(e){let{modelPath:t,baseScene:a=[],resourcePath:n,panel:o,infoPanel:r,progress:l,getModalInfo:i,container:s}=e;this.camera={},this.scene={},this.renderer={},this.controls={},this.trackballControls={},this.checkedModal={},this.modelObject=[],this.composer={},this.renderPass={},this.outlinePass={},this.effectFXAA={},this.modelPath=t,this.resourcePath=n,this.panel=o,this.infoPanel=r,this.container=s,this.clock=new be.l,this.progress=l,this.getModalInfo=i,this.modalType="",this.dirLight={},this.dragControls={},this.dirLightBack={},this.transformControls={},this.mesh={},this.baseScene=a,this.world={},this.initSceneCamera=nt,this.createGround=ot,this.webGLControls=ct,this.heightLight=bt,this.InitModel=Et,this.onWindowResize=this.onWindowResize.bind(this),this.init=this.init.bind(this),this.animate=this.animate.bind(this)}setCheckedModal(e){this.checkedModal=e}async init(){console.log("class modal init--------------"),this.initSceneCamera(),this.createGround(),this.InitModel(this.baseScene,[]),this.webGLControls(),this.heightLight(),window.addEventListener("resize",this.onWindowResize)}onWindowResize(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)}animate(){requestAnimationFrame(this.animate);const e=this.clock.getDelta();this.mixer&&this.mixer.update&&this.mixer.update(e),this.renderer.render(this.scene,this.camera),this.controls.update()}rotate(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"X";switch(console.log(this.checkedModal),t){case"X":this.checkedModal.rotateX(e);break;case"Y":this.checkedModal.rotateY(e);break;case"Z":this.checkedModal.rotateZ(e)}}exportModal(){const e=new fe.a,t=this,a=this.scene.getObjectByName("Floor");a&&this.scene.remove(a),e.parse(this.scene,(function(e){const a=JSON.stringify(e,null,2);t.downloadJSON(a,"scene.gltf")}))}downloadJSON(e,t){const a=new Blob([e],{type:"application/json"}),n=URL.createObjectURL(a),o=document.createElement("a");o.href=n,o.download=t,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL(n)}zoom(e,t,a){console.log(this.checkedModal),this.checkedModal.scale.set(e,t,a)}move(e){let{x:t,y:a,z:n}=e;console.log(this.checkedModal),this.checkedModal.translateX(t),this.checkedModal.translateY(a),this.checkedModal.translateZ(n)}remove(){window.confirm("\u5220\u9664\u540e\u6a21\u578b\u4f1a\u6d88\u5931!\u8bf7\u8c28\u614e\u64cd\u4f5c")&&(this.transformControls.detach(),this.scene.remove(this.checkedModal),console.log("remove ---\x3e",this.checkedModal,this.scene))}clone(){const e=this.checkedModal.clone(),t=this.checkedModal.position.x,a=this.checkedModal.position.y,n=this.checkedModal.position.z;e.position.set(t,a+6,n),e.children.forEach(t=>{t.parentGroup=e,t.children.forEach(t=>{t.parentGroup=e})}),this.scene.add(e),console.log("clone ---\x3e",e)}},wt=(a(541),a(92));const yt=Object(wt.b)({name:"checkedModal",initialState:{value:null},reducers:{setModal:(e,t)=>{e.value=t.payload}}}),kt=Object(wt.a)({reducer:yt.reducer});let Ct=null,xt=null;l.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(_e.a,{maxSnack:3,anchorOrigin:{vertical:"bottom",horizontal:"center"}},o.a.createElement(i.a,{store:kt},o.a.createElement(ze.a,null,o.a.createElement(Fe.d,null,o.a.createElement(Fe.b,{path:"/",Component:function(){const e=De(),t=Object(d.a)(),{enqueueSnackbar:a}=Object(_e.b)(),[r,l]=o.a.useState("undefined"==typeof localStorage||null==localStorage.getItem("homePopup")),[i,c]=o.a.useState(!1),[w,k]=o.a.useState(!1),[x,G]=o.a.useState(!1),[M,I]=o.a.useState(null),[P,_]=o.a.useState(window.location+"formats/FBX/models/\u5c0f\u53ef\u7231.fbx"),F=Object(Fe.p)(),D=()=>window.innerWidth/window.innerHeight>1,[z,V]=o.a.useState(D()),W=()=>{z&&V(D())};let[A,X]=Object(n.useState)("");const Z=e=>{console.log(e),F("/"+e)};window.addEventListener("resize",W,!1),window.addEventListener("orientationchange",W,!1);const[H,T]=o.a.useState(!0),U=Object(Fe.n)();return Object(n.useEffect)(()=>{X(U.pathname)},[U]),o.a.createElement("div",{className:e.root},o.a.createElement(ee,{open:r,setOpen:l,onClose:()=>{"undefined"!=typeof localStorage&&localStorage.setItem("homePopup",!0)}}),o.a.createElement(me,{open:i,setOpen:c,setFile:_}),o.a.createElement(Ne,{open:w,setOpen:k,setFile:_}),o.a.createElement(Pe,{open:x,setOpen:G,format:M,setFile:_}),o.a.createElement(b.a,null),o.a.createElement(h.a,{position:"fixed",className:Object(s.a)(e.appBar,{[e.appBarShift]:z})},o.a.createElement(p.a,{style:{backgroundColor:"#000"}},o.a.createElement(v.a,{color:"inherit","aria-label":"open drawer",onClick:()=>V(!0),edge:"start",className:Object(s.a)(e.menuButton,{[e.hide]:z})},o.a.createElement(y.a,null)),o.a.createElement(f.a,{variant:"h6",noWrap:!0},o.a.createElement("span",{style:{color:"#fff"}},"Singapore Art Museum")," ",o.a.createElement("span",{style:{color:"#e61563"}},"Digital Curatorial Platform")),o.a.createElement("div",{className:e.grow}),o.a.createElement("div",{className:e.sectionDesktop}),o.a.createElement("div",{className:e.sectionMobile},o.a.createElement(u.a,{href:"https://github.com/rufus31415",color:"inherit",target:"_blank"},o.a.createElement(v.a,{"aria-label":"GitHub","aria-haspopup":"true",color:"inherit"},o.a.createElement(R.a,null))),o.a.createElement(v.a,{"aria-label":"Info","aria-haspopup":"true",color:"inherit",onClick:()=>l(!0)},o.a.createElement(B.a,null))))),o.a.createElement(m.a,{variant:"permanent",className:Object(s.a)(e.drawer,{[e.drawerOpen]:z,[e.drawerClose]:!z}),classes:{paper:Object(s.a)({[e.drawerOpen]:z,[e.drawerClose]:!z})}},o.a.createElement("div",{className:e.toolbar},o.a.createElement(v.a,{onClick:()=>V(!1)},"rtl"===t.direction?o.a.createElement(S.a,null):o.a.createElement(C.a,null))),o.a.createElement(E.a,null),o.a.createElement(g.a,null,o.a.createElement(O.a,{button:!0,key:"home","data-key":"home",onClick:()=>Z("home"),selected:"/home"===A,classes:{selected:"selected"}},o.a.createElement(j.a,null,o.a.createElement(L.a,null)),o.a.createElement(N.a,{primary:"Home"})),o.a.createElement(O.a,{button:!0,key:"browserImage",classes:{selected:"selected"},selected:"browserImage"===A,onClick:()=>{W(),k(!0)}},o.a.createElement(j.a,null,o.a.createElement(L.a,null)),o.a.createElement(N.a,{primary:"Creation of Bounding Shapes"})),o.a.createElement(O.a,{button:!0,key:"zoning",classes:{selected:"selected"},selected:"/zoning"===A,onClick:()=>Z("zoning")},o.a.createElement(j.a,null,o.a.createElement(L.a,null)),o.a.createElement(N.a,{primary:"Zoning Selection"})),o.a.createElement(O.a,{button:!0,key:"livestream",onClick:()=>Z("samuel")},o.a.createElement(j.a,null,o.a.createElement(L.a,null)),o.a.createElement(N.a,{primary:"SAMuel"})),o.a.createElement(O.a,{button:!0,key:"photogrammetry",onClick:()=>{window.location.href="http://127.0.0.1:5001"}},o.a.createElement(j.a,null,o.a.createElement(L.a,null)),o.a.createElement(N.a,{primary:"Photogrammetry"}))),o.a.createElement(E.a,null)),o.a.createElement("main",{className:e.content},o.a.createElement(Fe.a,null)))}},o.a.createElement(Fe.b,{path:"home",Component:()=>{const{enqueueSnackbar:e}=Object(_e.b)(),t=(t,a)=>{e(a,{variant:t})},a=at(),[n,r]=o.a.useState("".concat(tt,"/\u5c0f\u53ef\u7231.fbx")),[l,i]=o.a.useState(!0);return o.a.createElement("div",null,o.a.createElement("div",{className:a.toolbar}),o.a.createElement(ae.a,{elevation:3,className:a.innerContent},o.a.createElement(Ye.a,{className:a.backdrop,open:l},o.a.createElement(Ue.a,{color:"inherit"})),o.a.createElement(Qe,{file:n,onReady:()=>{i(!1)},onLoaded:()=>{t("success","Model loaded with success"),i(!1)},onError:()=>{t("error","An error has occurred. If you are trying to load a model, could you please email it to me at rufus31415@gmail.com ?"),i(!1)}})))}}),o.a.createElement(Fe.b,{path:"zoning",Component:()=>{const e=He();let[t,a]=Object(n.useState)([]),[r,l]=Object(n.useState)([]);const i=Object(Fe.p)(),s=e=>{let n=t.findIndex(t=>t===e);-1===n?t.push(e):t.splice(n,1),a([...t])},c=e=>{let t=r.findIndex(t=>t===e);-1===t?r.push(e):r.splice(t,1),l([...r])};return o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:e.toolbar}),o.a.createElement("div",{className:"img-wrapper"},o.a.createElement("img",{src:We.a,alt:"",style:{width:"1000px",height:"700px"}}),o.a.createElement(Ze,{currentValue:t,checked:e=>s(e),position:{top:202,left:318},value:"b7"}),o.a.createElement(Ze,{currentValue:t,checked:e=>s(e),position:{top:202,left:433},value:"b8"}),o.a.createElement(Ze,{currentValue:t,checked:e=>s(e),position:{top:202,left:549},value:"b9"}),o.a.createElement(Ze,{currentValue:t,checked:e=>s(e),position:{top:309,left:202},value:"c6"}),o.a.createElement(Ze,{currentValue:t,checked:e=>s(e),position:{top:309,left:318},value:"c7"}),o.a.createElement(Ze,{currentValue:t,checked:e=>s(e),position:{top:309,left:433},value:"c8"}),o.a.createElement(Ze,{currentValue:t,checked:e=>s(e),position:{top:309,left:549},value:"c9"}),o.a.createElement(Ze,{currentValue:t,checked:e=>s(e),position:{top:421,left:202},value:"d6"}),o.a.createElement(Ze,{currentValue:t,checked:e=>s(e),position:{top:421,left:318},value:"d7"}),o.a.createElement(Ze,{currentValue:t,checked:e=>s(e),position:{top:421,left:433},value:"d8"}),o.a.createElement(Ze,{currentValue:t,checked:e=>s(e),position:{top:421,left:549},value:"d9"}),o.a.createElement(Ze,{currentValue:t,checked:e=>s(e),position:{top:312,left:724},width:139,value:"c11"}),o.a.createElement(Ze,{currentValue:t,checked:e=>s(e),position:{top:418,left:724},width:139,value:"d11"})),o.a.createElement("div",{className:"operate-bar"},o.a.createElement(_.a,{onClick:()=>(()=>{let e=t.length>0?t.join(","):"";i("/modelDetail?params=".concat(e))})(),variant:"contained"},"CONFIRM")),o.a.createElement("div",{className:"img-wrapper",style:{marginTop:"20px"}},o.a.createElement("img",{src:Xe.a,alt:"",style:{width:"1000px",height:"700px"}}),o.a.createElement(Ze,{currentValue:r,checked:e=>c(e),position:{top:168,left:174},width:166,height:164,value:"c1"}),o.a.createElement(Ze,{currentValue:r,checked:e=>c(e),position:{top:168,left:396},width:166,height:164,value:"b1"}),o.a.createElement(Ze,{currentValue:r,checked:e=>c(e),position:{top:168,left:609},width:166,height:164,value:"a1"}),o.a.createElement(Ze,{currentValue:r,checked:e=>c(e),position:{top:396,left:174},width:166,height:164,value:"c2"}),o.a.createElement(Ze,{currentValue:r,checked:e=>c(e),position:{top:396,left:396},width:166,height:164,value:"b2"}),o.a.createElement(Ze,{currentValue:r,checked:e=>c(e),position:{top:396,left:609},width:166,height:164,value:"a2"})),o.a.createElement("div",{className:"operate-bar"},o.a.createElement(_.a,{onClick:()=>(()=>{let e=r.length>0?r.join(","):"";i("/modelDetail?params=".concat(e))})(),variant:"contained"},"CONFIRM")))}}),o.a.createElement(Fe.b,{path:"samuel",Component:()=>{const e=Te();return o.a.createElement("div",{className:"container"},o.a.createElement("div",{className:e.toolbar}),o.a.createElement("div",{style:{maxWidth:1280,width:"100%",alignItems:"center",justifyContent:"center",display:"flex"}},o.a.createElement("h3",{style:{width:"50%",textAlign:"center"}},"Camera 1"),o.a.createElement("h3",{style:{width:"50%",textAlign:"center"}},"Camera 2")),o.a.createElement("div",{style:{maxWidth:1280,width:"100%",alignItems:"center",display:"flex"}},o.a.createElement("div",{style:{width:"50%"}},o.a.createElement("img",{src:"http://127.0.0.1:5001/video_feed/0",style:{border:"none"}})),o.a.createElement("div",{style:{width:"50%"}},o.a.createElement("img",{src:"http://127.0.0.1:5001/video_feed/1",style:{border:"none"}}))))}})),o.a.createElement(Fe.b,{path:"/modelDetail",Component:()=>{let[e,t]=Object(n.useState)(!0),[a,r]=Object(n.useState)(1),[l,i]=Object(n.useState)(1),[s,c]=Object(n.useState)({modal:null});const d=new URLSearchParams(Object(Fe.n)().search);Object(n.useEffect)(()=>{console.log("update view",a,Ct);const e=d.get("params");xt=new vt({container:document.querySelector("#detail"),baseScene:e.split(",")}),xt.init(),xt.animate(),m()},[]);const m=()=>{xt.renderer.domElement.addEventListener("mousedown",(function(e){var t;let a=new be.ac,n=new be.Db;a.x=e.clientX/window.innerWidth*2-1,a.y=-e.clientY/window.innerHeight*2+1,n.setFromCamera(a,xt.camera);const o=(null===(t=n.intersectObjects(xt.scene.children)[0])||void 0===t?void 0:t.object)||null,r=document.querySelector("#ModalPanel");console.log("click modal",o),o.parentGroup&&o.parentGroup.name.includes("modal")?(xt.transformControls.attach(o.parentGroup),r.style.visibility="visible",Ct=o.parentGroup,xt.checkedModal=Ct):r.style.visibility="hidden"}),!1)},h=a=>{console.log(a),t(a),console.log(e)},u=()=>{const e=document.querySelector("#upload");e.click(),e.addEventListener("change",(function(){const e=URL.createObjectURL(this.files[0]);(new ft.a).load(e,e=>{e.scene.name="modal",e.scene.position.set(0,20,20),e.scene.children.forEach(t=>{t.parentGroup=e.scene,t.children.forEach(t=>{t.parentGroup=e.scene})}),xt.scene.add(e.scene),console.log("obj.scene -------\x3e",e.scene)})}))},p=()=>o.a.createElement("div",null,o.a.createElement("div",null,"Rotate around X\uff1a",o.a.createElement("input",{type:"number",defaultValue:0,max:360,min:-360,name:"angleX"}),"\xa0\xa0degree"),o.a.createElement("div",null,"Rotate around Y\uff1a",o.a.createElement("input",{type:"number",defaultValue:0,max:360,min:-360,name:"angleY"}),"\xa0\xa0degree"),o.a.createElement("div",null,"Rotate around Z\uff1a",o.a.createElement("input",{type:"number",defaultValue:0,max:360,min:-360,name:"angleZ"}),"\xa0\xa0degree")),g=()=>o.a.createElement("div",null,o.a.createElement("div",null,"X-axis\uff1a",o.a.createElement("input",{type:"number",defaultValue:1,step:"0.01",max:100,min:0,name:"scaleX"}),"\xa0\xa0ratio"),o.a.createElement("div",null,"Y-axis\uff1a",o.a.createElement("input",{type:"number",defaultValue:1,step:"0.01",max:100,min:0,name:"scaleY"}),"\xa0\xa0ratio"),o.a.createElement("div",null,"Z-axis\uff1a",o.a.createElement("input",{type:"number",defaultValue:1,step:"0.01",max:100,min:0,name:"scaleZ"}),"\xa0\xa0ratio")),b=()=>o.a.createElement("div",null,o.a.createElement("div",null,"X-axis\uff1a",o.a.createElement("input",{type:"number",defaultValue:0,name:"moveX"}),"\xa0\xa0"),o.a.createElement("div",null,"Y-axis\uff1a",o.a.createElement("input",{type:"number",defaultValue:0,name:"moveY"}),"\xa0\xa0"),o.a.createElement("div",null,"Z-axis\uff1a",o.a.createElement("input",{type:"number",defaultValue:0,name:"moveZ"}),"\xa0\xa0")),f=()=>o.a.createElement("div",null,o.a.createElement("div",null,o.a.createElement(_.a,{onClick:()=>{xt.remove()},style:{backgroundColor:"red",color:"#fff"}},"Delete")),o.a.createElement("div",null,o.a.createElement(_.a,{onClick:()=>{xt.clone()},style:{backgroundColor:"#fff"}},"Clone")));return o.a.createElement("div",{id:"detail"},o.a.createElement("div",{className:"modal-operate-bar",style:e?{animation:"expand 1s both"}:{animation:"unexpand 1s both"}},s.value,s.key,o.a.createElement("div",{onClick:()=>h(!1),className:"modal-operate-bar_btn",style:{margin:"0 auto 0 0"}},"Close"),o.a.createElement("div",{onClick:()=>u(),className:"modal-operate-bar_btn"},"Upload Model"),o.a.createElement("div",{onClick:()=>{xt.exportModal()},className:"modal-operate-bar_btn"},"Export")),o.a.createElement("div",{id:"ModalPanel",className:"modal-panel"},o.a.createElement("div",{onClick:e=>(e=>{var t;let n=null===(t=e.target.attributes["data-index"])||void 0===t?void 0:t.value;if(n){if(n===a)return;r(n++)}})(e),className:"function-tag-list"},[{label:"Rotate",value:1},{label:"Zoom",value:2},{label:"Move",value:3},{label:"Other",value:4}].map(e=>e.value===a?o.a.createElement("div",{key:e.value,"data-index":e.value,className:"function-tag-list_item function-tag-list_item--active"},e.label):o.a.createElement("div",{key:e.value,"data-index":e.value,className:"function-tag-list_item"},e.label))),o.a.createElement("form",{onSubmit:e=>(e=>{e.preventDefault();const t=document.querySelector("#ModalPanelForm"),n=new FormData(t);switch(console.log(xt),a){case 1:const e=n.get("angleX"),a=n.get("angleY"),o=n.get("angleZ");xt.rotate(e,"X"),xt.rotate(a,"Y"),xt.rotate(o,"Z"),t.reset();break;case 2:const r=n.get("scaleX"),l=n.get("scaleY"),i=n.get("scaleZ");xt.zoom(r,l,i),t.reset();break;case 3:const s=n.get("moveX"),c=n.get("moveY"),d=n.get("moveZ");xt.move({x:s,y:c,z:d}),t.reset()}})(e),id:"ModalPanelForm"},(()=>{switch(a){case 1:return p;case 2:return g;case 3:return b;case 4:return f}})()(),o.a.createElement("div",{className:"submit-btn"},o.a.createElement(_.a,{type:"submit",style:{background:"#fff"}},"Confirm")))),o.a.createElement("div",{onClick:()=>h(!0),style:e?{display:"none"}:{animation:"large 1s 1s both"},className:"modal-operate-bar--unexpand"},"Expand"),o.a.createElement("input",{accept:".gltf,.glb",id:"upload",type:"file",style:{visibility:"hidden",width:0,height:0,position:"fixed"}}))}}),o.a.createElement(Fe.b,{path:"/test",Component:function(){return n.createElement("div",null,"hello")}})))))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(e=>{e.unregister()}).catch(e=>{console.error(e.message)})}},[[160,1,2]]]);
//# sourceMappingURL=main.4bb2c7fe.chunk.js.map